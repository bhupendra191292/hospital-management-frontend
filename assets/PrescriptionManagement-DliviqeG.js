import{f as q,r as i,j as e}from"./index-CWlqgBx2.js";import{o as I,j as E,a as A,c as f}from"./MedicalRecordsModal-Cxk0sOBw.js";import{M,a as R}from"./ModalHeader-CjtU9wNv.js";import"./index-NIGUFBhG.js";const B=()=>{const{user:k}=q(),[N,n]=i.useState(!1),[d,v]=i.useState([]),[m,g]=i.useState([]),[O,y]=i.useState([]),[b,u]=i.useState(!1),[l,o]=i.useState(!1),[a,h]=i.useState({patientId:"",medication:"",dosage:"",frequency:"Once daily",duration:"",instructions:"",notes:"",refills:0}),p=["Once daily","Twice daily","Three times daily","Four times daily","Every 4 hours","Every 6 hours","Every 8 hours","Every 12 hours","As needed","Before meals","After meals","At bedtime"];i.useEffect(()=>{c(),C(),w()},[]);const c=async()=>{try{u(!0);const s=await I({limit:10});s.data.success&&v(s.data.data.prescriptions||[])}catch(s){console.error("Error loading prescriptions:",s)}finally{u(!1)}},C=async()=>{try{const s=await E({limit:100});s.data.success&&g(s.data.data.patients||[])}catch(s){console.error("Error loading patients:",s)}},w=async()=>{try{const s=await A();s.data.success&&y(s.data.data.doctors||[])}catch(s){console.error("Error loading doctors:",s)}},t=s=>{const{name:r,value:D}=s.target;h(S=>({...S,[r]:D}))},x=async s=>{s.preventDefault();try{o(!0),(await f(a)).data.success&&(alert("Prescription created successfully!"),h({patientId:"",medication:"",dosage:"",frequency:"Once daily",duration:"",instructions:"",notes:"",refills:0}),n(!1),c())}catch(r){console.error("Error creating prescription:",r),alert("Failed to create prescription. Please try again.")}finally{o(!1)}},j=async()=>{try{o(!0);const s={...a,status:"Draft"};(await f(s)).data.success&&(alert("Prescription saved as draft!"),n(!1),c())}catch(s){console.error("Error saving draft:",s),alert("Failed to save draft. Please try again.")}finally{o(!1)}},F=s=>new Date(s).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"}),P=s=>({Active:"status-active",Completed:"status-completed",Cancelled:"status-cancelled",Draft:"status-draft"})[s]||"status-default";return e.jsxs("div",{className:"prescription-management",children:[e.jsx("div",{className:"prescription-header",children:e.jsxs("div",{className:"header-content",children:[e.jsxs("div",{className:"header-title",children:[e.jsx("span",{className:"title-icon",children:"ðŸ’Š"}),e.jsx("h1",{children:"Prescription Management"})]}),e.jsxs("div",{className:"header-actions",children:[e.jsx("button",{className:"btn-primary",onClick:()=>n(!0),children:"New Prescription"}),e.jsx("button",{className:"btn-secondary",children:"View All"})]})]})}),e.jsxs("div",{className:"create-prescription-card",children:[e.jsx("h2",{children:"Create New Prescription"}),e.jsxs("form",{onSubmit:x,className:"prescription-form",children:[e.jsx("div",{className:"form-row",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"patientId",children:"Patient *"}),e.jsxs("select",{id:"patientId",name:"patientId",value:a.patientId,onChange:t,required:!0,className:"form-input",children:[e.jsx("option",{value:"",children:"Select Patient"}),m.map(s=>e.jsxs("option",{value:s._id||s.id,children:[s.name," (UHID: ",s.uhid,")"]},s._id||s.id))]})]})}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"medication",children:"Medication *"}),e.jsx("input",{type:"text",id:"medication",name:"medication",value:a.medication,onChange:t,required:!0,className:"form-input",placeholder:"Enter medication name"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"dosage",children:"Dosage *"}),e.jsx("input",{type:"text",id:"dosage",name:"dosage",value:a.dosage,onChange:t,required:!0,className:"form-input",placeholder:"e.g., 500mg"})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"frequency",children:"Frequency *"}),e.jsx("select",{id:"frequency",name:"frequency",value:a.frequency,onChange:t,required:!0,className:"form-input",children:p.map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"duration",children:"Duration *"}),e.jsx("input",{type:"text",id:"duration",name:"duration",value:a.duration,onChange:t,required:!0,className:"form-input",placeholder:"e.g., 5 days"})]})]}),e.jsx("div",{className:"form-row",children:e.jsxs("div",{className:"form-group full-width",children:[e.jsx("label",{htmlFor:"instructions",children:"Instructions"}),e.jsx("textarea",{id:"instructions",name:"instructions",value:a.instructions,onChange:t,className:"form-textarea",placeholder:"Special instructions for the patient",rows:"3"})]})}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"refills",children:"Refills"}),e.jsx("input",{type:"number",id:"refills",name:"refills",value:a.refills,onChange:t,min:"0",className:"form-input",placeholder:"0"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"notes",children:"Notes"}),e.jsx("input",{type:"text",id:"notes",name:"notes",value:a.notes,onChange:t,className:"form-input",placeholder:"Additional notes"})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"button",className:"btn-secondary",onClick:j,disabled:l,children:"Save as Draft"}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:l,children:l?"Creating...":"Create Prescription"})]})]})]}),e.jsxs("div",{className:"recent-prescriptions",children:[e.jsx("h2",{children:"Recent Prescriptions"}),b?e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Loading prescriptions..."})]}):d.length>0?e.jsx("div",{className:"prescriptions-list",children:d.map(s=>{var r;return e.jsxs("div",{className:"prescription-card",children:[e.jsxs("div",{className:"prescription-header",children:[e.jsxs("div",{className:"prescription-info",children:[e.jsx("h3",{children:s.medication}),e.jsx("p",{className:"patient-name",children:((r=s.patientId)==null?void 0:r.name)||"Unknown Patient"})]}),e.jsx("div",{className:"prescription-status",children:e.jsx("span",{className:`status-badge ${P(s.status)}`,children:s.status})})]}),e.jsxs("div",{className:"prescription-details",children:[e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"Dosage:"}),e.jsx("span",{className:"detail-value",children:s.dosage})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"Frequency:"}),e.jsx("span",{className:"detail-value",children:s.frequency})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"Duration:"}),e.jsx("span",{className:"detail-value",children:s.duration})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"Prescribed:"}),e.jsx("span",{className:"detail-value",children:F(s.prescribedDate)})]})]}),s.instructions&&e.jsxs("div",{className:"prescription-instructions",children:[e.jsx("span",{className:"instructions-label",children:"Instructions:"}),e.jsx("span",{className:"instructions-text",children:s.instructions})]})]},s._id||s.id)})}):e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-icon",children:"ðŸ’Š"}),e.jsx("p",{children:"No prescriptions found"}),e.jsx("button",{className:"btn-primary",onClick:()=>n(!0),children:"Create First Prescription"})]})]}),e.jsxs(M,{isOpen:N,onClose:()=>n(!1),className:"create-prescription-modal",children:[e.jsx(R,{title:"Create New Prescription",icon:"ðŸ’Š",onClose:()=>n(!1)}),e.jsx("div",{className:"modal-content",children:e.jsxs("form",{onSubmit:x,className:"prescription-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"modal-patientId",children:"Patient *"}),e.jsxs("select",{id:"modal-patientId",name:"patientId",value:a.patientId,onChange:t,required:!0,className:"form-input",children:[e.jsx("option",{value:"",children:"Select Patient"}),m.map(s=>e.jsxs("option",{value:s._id||s.id,children:[s.name," (UHID: ",s.uhid,")"]},s._id||s.id))]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"modal-medication",children:"Medication *"}),e.jsx("input",{type:"text",id:"modal-medication",name:"medication",value:a.medication,onChange:t,required:!0,className:"form-input",placeholder:"Enter medication name"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"modal-dosage",children:"Dosage *"}),e.jsx("input",{type:"text",id:"modal-dosage",name:"dosage",value:a.dosage,onChange:t,required:!0,className:"form-input",placeholder:"e.g., 500mg"})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"modal-frequency",children:"Frequency *"}),e.jsx("select",{id:"modal-frequency",name:"frequency",value:a.frequency,onChange:t,required:!0,className:"form-input",children:p.map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"modal-duration",children:"Duration *"}),e.jsx("input",{type:"text",id:"modal-duration",name:"duration",value:a.duration,onChange:t,required:!0,className:"form-input",placeholder:"e.g., 5 days"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"modal-instructions",children:"Instructions"}),e.jsx("textarea",{id:"modal-instructions",name:"instructions",value:a.instructions,onChange:t,className:"form-textarea",placeholder:"Special instructions for the patient",rows:"3"})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"modal-refills",children:"Refills"}),e.jsx("input",{type:"number",id:"modal-refills",name:"refills",value:a.refills,onChange:t,min:"0",className:"form-input",placeholder:"0"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"modal-notes",children:"Notes"}),e.jsx("input",{type:"text",id:"modal-notes",name:"notes",value:a.notes,onChange:t,className:"form-input",placeholder:"Additional notes"})]})]}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>n(!1),children:"Cancel"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:j,disabled:l,children:"Save as Draft"}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:l,children:l?"Creating...":"Create Prescription"})]})]})})]})]})};export{B as default};
